///////////////////////////////////////////////////////
//    Pluto SAID parametrization implementation file
//    SAID pn-elastic parametrization.
//    Created by Mirian Tabidze;  
//    ANKE/PAX Collaboration (2010)
//
////////////////////////////////////////////////////////


#include "PSaidPN.h"

const long double d2r = 3.14159265358979323846/180.;

PSaidPN::PSaidPN() {
};

PSaidPN::PSaidPN(const Char_t *id, const Char_t *de) :
    PAngularDistribution(id, de) {
    dim = 180-1;

    y.Set(dim+1);
    aa.Set(dim);
    told = -1.;

    beam = target = NULL;
};

PDistribution *PSaidPN::Clone(const char *) const {
    return new PSaidPN((const PSaidPN &)* this);
};

Bool_t PSaidPN::IsNotRejected(void) {
    
    if (!direct_sampling_done) {
	Fatal("IsNotRejected", "Sampling not finished");
    }
    return kTRUE;
};

Bool_t PSaidPN::Init(void) {
    
    if (!PAngularDistribution::Init()) return kFALSE;

    if (!beam || !target) {
	Warning("Init", "beam or target not found");
	return kFALSE;
    }

    return kTRUE;
}


Bool_t PSaidPN::Prepare(void) {
    return kTRUE;
}

double PSaidPN::SamplePolarAngle(double r) {
    //boost particle 2 such to be in particle 1 rest frame

    PParticle tmp(beam);  //particle under investigation. Make better a copy
    tmp.Boost(-target->BoostVector());
    Double_t tlab = tmp.KE();

    return sample(r, tlab);
}


double PSaidPN::dsdw(double th, double tlab) {

    // Normalized np elastic differential cross sections (mb/sr);
    // arguments: scattering angle (deg), lab beam kinetic energy (GeV).
    // Parametrized beam kinetic energy range 1-3000 MeV. 
    // Created by Nodar Lomidze and Mirian Tabidze;
    // ANKE/PAX Collaboration 10.01.2010.
    
    Double_t Tlab = tlab*1000;    
    
    //    1 < t  <=  10  MeV
    
    Double_t a711=4539.60307960841601015999913216;
    Double_t a721=0.00752681897087725815254088956863;
    Double_t a731=-6.78245408535227412016865855549e-05;
    
    Double_t a712=4539.02501799385299818823114038;
    Double_t a722=0.0195923919679152902517671464011;
    Double_t a732=-5.90373107640998484590966199903e-05;
    
    Double_t a713=4542.63246565786630526417866349;
    Double_t a723=-0.0367270219040887191397359856637;
    Double_t a733=0.000150479366404190212369584855878;
  
    Double_t a714=4599.64072085160387359792366624;
    Double_t a724=-0.69636713261622606996326112494;
    Double_t a734=0.00204901580574626523273407130432;
  
    Double_t b711=1027.1110718433226338675012812;
    Double_t b721=-0.00250973591724257261148522957228;
    Double_t b731=3.40351275642941653032380600052e-05;
  
    b711=b711*1e-3;
    b721=b721*1e-3;
    b731=b731*1e-3;
                                        
    Double_t b712=1027.30197644404802304052282125;
    Double_t b722=-0.00603008467870358444429257360753;
    Double_t b732=2.20231569236263580169321585345e-05;
  
    b712=b712*1e-3;
    b722=b722*1e-3;
    b732=b732*1e-3;
                                                                                  
    Double_t b713=1025.79594553870083473157137632;
    Double_t b723=0.017633572296861910189136324334;
    Double_t b733=-6.77495961738348861924663424361e-05;
  
    b713=b713*1e-3;
    b723=b723*1e-3;
    b733=b733*1e-3;
    
    Double_t b714=1006.11632161798411289055366069;
    Double_t b724=0.24496891365587847300133716999;
    Double_t b734=-0.000720654698491387602291013969591;
  
    b714=b714*1e-3;
    b724=b724*1e-3;
    b734=b734*1e-3;
                                                                                                               
    Double_t c711=-3956.28582875398979012970812619;
    Double_t c721=0.436230037021566374733083648607;
    Double_t c731=-0.00861326169470216784773697327182;
  
    c711=c711*1e-6;
    c721=c721*1e-6;
    c731=c731*1e-6;
                                                                                                              
    Double_t c712=-3982.55195758380932602449320257;
    Double_t c722=0.747615347868268109721157088643;
    Double_t c732=-0.00302084300206519051901210559663;
  
    c712=c712*1e-6;
    c722=c722*1e-6;
    c732=c732*1e-6;
                                                               
    Double_t c713=-3707.52255752172231950680725276;
    Double_t c723=-3.61276538826876914001218210615;
    Double_t c733=0.0137295676718120068793282939623;
  
    c713=c713*1e-6;
    c723=c723*1e-6;
    c733=c733*1e-6;
                                                                                        
    Double_t c714=-376.734120560502560692839324474;
    Double_t c724=-41.9878472921726668687369965483;
    Double_t c734=0.123605984540839264340661429742;

    c714=c714*1e-6;
    c724=c724*1e-6;
    c734=c734*1e-6;
               
    Double_t d711=550339822899.100830078125;
    Double_t d721=-15437424.6341329850256443023682;
    Double_t d731=377735.00044624751899391412735;
  
    d711=d711*1e-9;
    d721=d721*1e-9;
    d731=d731*1e-9;
                                                                                                             
    Double_t d712=551330896329.685302734375;
    Double_t d722=-28402879.7241111062467098236084;
    Double_t d732=201350.6160830332082696259021760;
  
    d712=d712*1e-9;
    d722=d722*1e-9;
    d732=d732*1e-9;
                                                      
    Double_t d713=534982789012.4525146484375;
    Double_t d723=231614124.018608659505844116211;
    Double_t d733=-806692.935594742302782833576202;
  
    d713=d713*1e-9;
    d723=d723*1e-9;
    d733=d733*1e-9;
                                                                                
    Double_t d714=324213961620.5838623046875;
    Double_t d724=2679043927.8085079193115234375;
    Double_t d734=-7877500.49959708191454410552979;
  
    d714=d714*1e-9;
    d724=d724*1e-9;
    d734=d734*1e-9;
         
    Double_t e711=-4777302473008.5888671875;
    Double_t e721=9785749.0821783803403377532959;
    Double_t e731=-83059.2992513257631799206137657;
  
    e711=e711*1e-9;
    e721=e721*1e-9;
    e731=e731*1e-9;
                                                                                                      
    Double_t e712=-4778242712167.7001953125;
    Double_t e722=30444273.1718424744904041290283;
    Double_t e732=-104675.355601904535433277487755;
  
    e712=e712*1e-9;
    e722=e722*1e-9;
    e732=e732*1e-9;
                                                              
    Double_t e713=-4771744055772.7490234375;
    Double_t e723=-71079311.6152839064598083496094;
    Double_t e733=278945.57256805134238675236702;
  
    e713=e713*1e-9;
    e723=e723*1e-9;
    e733=e733*1e-9;
                                                                                 
    Double_t e714=-4684500557379.8388671875;
    Double_t e724=-1079706906.676479339599609375;
    Double_t e734=3177793.29517898336052894592285;

    e714=e714*1e-9;
    e724=e724*1e-9;
    e734=e734*1e-9;

    //    10 < t  <=  150  MeV
  
    Double_t a011=280.988883232264015532564371824;
    Double_t a021=-1.2177691742418588205509877298;
    Double_t a031=0.222128243817439507967748113515;
    Double_t a041=-0.00501823344764219109181979661116;
    Double_t a051=3.23246195376400931634740254506e-05;
  
    Double_t a012=252.537332079565970843759714626;
    Double_t a022=6.26598319895761868281169881811;
    Double_t a032=-0.124214597690752104330869087789;
    Double_t a042=0.000878031017884496655170889489739;
    Double_t a052=-2.20075804836157298829892210723e-06;
  
    Double_t a013=2224.2910797913341411913279444;
    Double_t a023=-29.1165463720663275637434708187;
    Double_t a033=0.0295830042274358925857846713825;
    Double_t a043=0.00116812273353987246087004603368;
    Double_t a053=-4.31766062565598209379603977798e-06;
  
    Double_t a014=-3571.52045872113558289129287004;
    Double_t a024=49.9587605670696888182646944188 ;
    Double_t a034=-0.0118980651043120617960102691768;
    Double_t a044=-0.001885748021239132439508257022;
    Double_t a054=5.91472087493390507695160962509e-06;
                     
    Double_t b011=-0.368600091598161427874913442793;
    Double_t b021=0.00070921291732507470498281243465;
    Double_t b031=-0.000210439809892587167180350027351;
    Double_t b041=6.10126041381089026703296064602e-07;
    Double_t b051=5.86115757976900380346970591619e-08;
                    
    Double_t b012=-0.334604425563661378451030259384;
    Double_t b022=-0.00969373187740862202188552032567;
    Double_t b032=0.000180082736553450122951938738858;
    Double_t b042=-1.04216649383704479223014104788e-06;
    Double_t b052=1.79718949566048717459940864589e-09;
                 
    Double_t b013=-0.226793636082256083730257500974;
    Double_t b023=-0.0108668467472905917042824697205;
    Double_t b033=0.000176873179439550565162850293;
    Double_t b043=-9.67900961915323784296371831259e-07;
    Double_t b053=1.57296915955838665368297633906e-09;
                    
    Double_t b014=-2.17784944926909851403706852579;
    Double_t b024=0.00987373490958328922650899528435 ;
    Double_t b034= 0.000140179428546595603866098400658;
    Double_t b044=-1.22367419558757078961580815751e-06;
    Double_t b054=2.57839465829339766884928802644e-09;
                                  
    Double_t c011=262.65818684088884538141428493;
    Double_t c021=1.28141669745747011077696697612;
    Double_t c031=-0.290574928599716564292521070456 ;
    Double_t c041=0.00647053047289599617825084365563;
    Double_t c051=-4.19262609199920786373985692741e-05;

    c011=c011*1e-3;
    c021=c021*1e-3;
    c031=c031*1e-3;
    c041=c041*1e-3;
    c051=c051*1e-3;
               
    Double_t c012=-24.7051973187336244563994114287;
    Double_t c022=7.83310921438477514300302573247;
    Double_t c032=-0.151544199915834149061666380476;
    Double_t c042=0.00142477553682942518348264471229;
    Double_t c052=-4.62153421185459635674424444529e-06;

    c012=c012*1e-3;
    c022=c022*1e-3;
    c032=c032*1e-3;
    c042=c042*1e-3;
    c052=c052*1e-3;
             
    Double_t c013=-5381.3442541142321715597063303;
    Double_t c023=80.9980424193125827514450065792;
    Double_t c033=-0.0107601485720134927570601490743;
    Double_t c043=-0.00400301507248122974413906405289;
    Double_t c053=1.42595594707078175380132387118e-05;

    c013=c013*1e-3;
    c023=c023*1e-3;
    c033=c033*1e-3;
    c043=c043*1e-3;
    c053=c053*1e-3;
                      
    Double_t c014=8395.32363116006308700889348984;
    Double_t c024=-106.289569664433187767826893833;
    Double_t c034=0.0402392918497720686321628136284;
    Double_t c044=0.00386630196197447527708956904746;
    Double_t c054=-1.2206692233255915381174953882e-05;
  
    c014=c014*1e-3;
    c024=c024*1e-3;
    c034=c034*1e-3;
    c044=c044*1e-3;
    c054=c054*1e-3;
                             
    Double_t d011=13809143.5907383374869823455811;
    Double_t d021=75389.9699077490950003266334534;
    Double_t d031=-12495.9410690938093466684222221;
    Double_t d041=132.974818864917722294194390997;
    Double_t d051=-0.208528757593841151951608026138;

    d011=d011*1e-6;
    d021=d021*1e-6;
    d031=d031*1e-6;
    d041=d041*1e-6;
    d051=d051*1e-6;
                   
    Double_t d012=18072482.8951823115348815917969;
    Double_t d022=-292744.751829294080380350351334;
    Double_t d032=-4379.86052800174275034805759788;
    Double_t d042=86.6978921142812879452321794815;
    Double_t d052=-0.322858560891928270120132538068;

    d012=d012*1e-6;
    d022=d022*1e-6;
    d032=d032*1e-6;
    d042=d042*1e-6;
    d052=d052*1e-6;
                      
    Double_t d013=1633901944.51936793327331542969;
    Double_t d023=-50812855.3188116699457168579102;
    Double_t d033=589775.797529974603094160556793;
    Double_t d043=-3029.60901487935143450158648193;
    Double_t d053=5.82883075531933325663658251869;

    d013=d013*1e-6;
    d023=d023*1e-6;
    d033=d033*1e-6;
    d043=d043*1e-6;
    d053=d053*1e-6;
                
    Double_t d014=49404326397.42669677734375;
    Double_t d024=-1191114835.2664012908935546875;
    Double_t d034=10744988.1387704908847808837891;
    Double_t d044=-42981.8272057931390008889138699;
    Double_t d054=64.3419332728879567184776533395;

    d014=d014*1e-6;
    d024=d024*1e-6;
    d034=d034*1e-6;
    d044=d044*1e-6;
    d054=d054*1e-6;
                                         
    Double_t e011=-30758522.9680781401693820953369;
    Double_t e021=-629133.209790516062639653682709;
    Double_t e031=29689.4940516852329892572015524;
    Double_t e041=146.154462075237404405925190076;
    Double_t e051=-4.84387015724178926490139929228;

    e011=e011*1e-9;
    e021=e021*1e-9;
    e031=e031*1e-9;
    e041=e041*1e-9;
    e051=e051*1e-9;
                         
    Double_t e012=-26628412.9835556410253047943115;
    Double_t e022=-741706.592572910012677311897278;
    Double_t e032=51206.4980289838058524765074253;
    Double_t e042=-609.778742025277210814238060266;
    Double_t e052=2.08472507718602884096981142648;

    e012=e012*1e-9;
    e022=e022*1e-9;
    e032=e032*1e-9;
    e042=e042*1e-9;
    e052=e052*1e-9;
                    
    Double_t e013=-922015280.121418356895446777344;
    Double_t e023=38500015.4333336949348449707031;
    Double_t e033=-552583.676858801511116325855255 ;
    Double_t e043=3356.65857880652174571878276765;
    Double_t e053=-7.4277079909561898318770545302;
  
    e013=e013*1e-9;
    e023=e023*1e-9;
    e033=e033*1e-9;
    e043=e043*1e-9;
    e053=e053*1e-9;
               
    Double_t e014=-285002237703.16705322265625;
    Double_t e024=6917510671.8432407379150390625;
    Double_t e034=-62834191.1933749467134475708008;
    Double_t e044=253128.074982627877034246921539;
    Double_t e054=-381.588734556700956090935505927;

    e014=e014*1e-9;
    e024=e024*1e-9;
    e034=e034*1e-9;
    e044=e044*1e-9;
    e054=e054*1e-9;

    //   150  <  t  <=  370  MeV

    Double_t a111=16.351113971386027401422325056;
    Double_t a121=0.0293374316957276323747372259731;
    Double_t a131=-0.00331936904518996978713518686277;
    Double_t a141=-5.78012727715596842550764555835e-05;
    Double_t a151=1.10296804110113708074483642591e-06;
                                                               
    Double_t a112=22.5326405949818777685322856996;
    Double_t a122=-0.205408182638080000215197173929;
    Double_t a132=-0.00407236806452648987530995583484 ;
    Double_t a142=6.91309992902746842232883373036e-05;
    Double_t a152=-2.44266682752841438297882652522e-07 ;
                                                                               
    Double_t a113=48.9620202894678016036777989939;
    Double_t a123=-2.01966497554739854436434143281;
    Double_t a133=0.0307230195733171757010993019321;
    Double_t a143=-0.000194897693464035219644905905234;
    Double_t a153=4.61399831830805130775574780799e-07;
                                                                               
    Double_t a114=-497.393960769805289601208642125;
    Double_t a124=4.97405314386081442989961942658;
    Double_t a134=0.0116672799448331223487462793287;
    Double_t a144=-0.000236013487613045188501237348078;
    Double_t a154=5.88389691314652550754773357999e-07;
                                                                    
    Double_t b111=-63.0232848709729367442378134001;
    Double_t b121=0.169797722983754506564935127244;
    Double_t b131=-0.139121795283793342479228272168;
    Double_t b141=0.00564659484777588639020651228861;
    Double_t b151=-6.08553506472555679938062078715e-05;

    b111=b111*1e-3;
    b121=b121*1e-3;
    b131=b131*1e-3;
    b141=b141*1e-3;
    b151=b151*1e-3;
                                                                               
    Double_t b112=-50.8279586212917351417672762182;
    Double_t b122=-3.61127434193662599781760036421;
    Double_t b132=0.117252381838553326742768945223;
    Double_t b142=-0.00117002602198994307830526295788;
    Double_t b152=3.74757919082132890967683745698e-06 ;

    b112=b112*1e-3;
    b122=b122*1e-3;
    b132=b132*1e-3;
    b142=b142*1e-3;
    b152=b152*1e-3;
                                                                               
    Double_t b113=-14.1499609189426607258610602003 ;
    Double_t b123=-1.11069574093095813083209577599;
    Double_t b133=0.00546449703268872457456728497505;
    Double_t b143=8.31571591438427879655614916032e-05;
    Double_t b153=-5.57682228099956647873215991734e-07;

    b113=b113*1e-3;
    b123=b123*1e-3;
    b133=b133*1e-3;
    b143=b143*1e-3;
    b153=b153*1e-3;
                                                                              
    Double_t b114=15770.775284139419454731978476;
    Double_t b124=-189.443404858807241453177994117;
    Double_t b134=0.00633854300141153091663337448836;
    Double_t b144=0.00662761879419255725554016578371;
    Double_t b154=-1.95891296946818993453438839669e-05;

    b114=b114*1e-3;
    b124=b124*1e-3;
    b134=b134*1e-3;
    b144=b144*1e-3;
    b154=b154*1e-3;
                                                                              
    Double_t c111=120.493591877953775792775559239;
    Double_t c121=-0.024991634332026002596194302896;
    Double_t c131=0.340852002172772283739021759175;
    Double_t c141=-0.0100743198136245687424050743175;
    Double_t c151=7.63650985701533194845852525745e-05;

    c111=c111*1e-6;
    c121=c121*1e-6;
    c131=c131*1e-6;
    c141=c141*1e-6;
    c151=c151*1e-6; 
                                                                              
    Double_t c112=624.624715290332233053050003946;
    Double_t c122= -11.2120750552410193279229133623;
    Double_t c132=0.0387871975796240595069086509739;
    Double_t c142=0.000465631784702261490235808416571;
    Double_t c152=-2.61137636249205722809886565106e-06;

    c112=c112*1e-6;
    c122=c122*1e-6;
    c132=c132*1e-6;
    c142=c142*1e-6;
    c152=c152*1e-6;
                                                                               
    Double_t c113=2029.17114502638014528201892972;
    Double_t c123=-26.6817075099832656803755526198;
    Double_t c133=-0.00738101725047722763417556990362;
    Double_t c143=0.0012863997150295693270433128319;
    Double_t c153=-4.0524914013150380159974592309e-06;

    c113=c113*1e-6;
    c123=c123*1e-6;
    c133=c133*1e-6;
    c143=c143*1e-6;
    c153=c153*1e-6;
                               
    Double_t c114=-47115.3281632940343115478754044;
    Double_t c124=575.899509969403652576147578657;
    Double_t c134=-0.0669339870303421874409011138596;
    Double_t c144=-0.0203290331289292212912922508394;
    Double_t c154=6.12045543080978813980930208771e-05;

    c114=c114*1e-6;
    c124=c124*1e-6;
    c134=c134*1e-6;
    c144=c144*1e-6;
    c154=c154*1e-6;
                                                                              
    Double_t d111=-71.7274004434660383822119911201;
    Double_t d121=1.14292452343935924119477931526;
    Double_t d131=-0.445365264308371477941506100251;
    Double_t d141=0.0117761611677180046825474946104;
    Double_t d151=-8.52034610302083170521592059288e-05;

    d111=d111*1e-9;
    d121=d121*1e-9;
    d131=d131*1e-9;
    d141=d141*1e-9;
    d151=d151*1e-9;
                                                                              
    Double_t d112=-314.193150437753502046689391136;
    Double_t d122=-2.39640444653943029962306354719;
    Double_t d132=0.173797000179225058502652245807;
    Double_t d142=-0.00189190132544531531416653891142;
    Double_t d152=6.13284141308662452486731922474e-06;

    d112=d112*1e-9;
    d122=d122*1e-9;
    d132=d132*1e-9;
    d142=d142*1e-9;
    d152=d152*1e-9;
                                                                              
    Double_t d113=-3017.51169359347613863064907491;
    Double_t d123=42.6440309279125671082510962151;
    Double_t d133=-0.00321909626470435117004398328788;
    Double_t d143=-0.0021387173466169361567279505465;
    Double_t d153=7.44228659469870493714180326172e-06;

    d113=d113*1e-9;
    d123=d123*1e-9;
    d133=d133*1e-9;
    d143=d143*1e-9;
    d153=d153*1e-9;
                                                                              
    Double_t d114=42360.4662757067781058140099049;
    Double_t d124=-522.786637329773043347813654691;
    Double_t d134=0.0744317850192869751024815627716;
    Double_t d144=0.0186267962961852821812680502944;
    Double_t d154=-5.65341755089525228547032986715e-05;

    d114=d114*1e-9;
    d124=d124*1e-9;
    d134=d134*1e-9;
    d144=d144*1e-9;
    d154=d154*1e-9;

    //    370 < t  <  700  MeV
                                             
    Double_t a211=38.8280288704706748603712185286;
    Double_t a221=-0.263982877781892999458079884789;
    Double_t a231=-0.0445072250500043870014010849445;
    Double_t a241=0.00120988294033848049063850638163;
    Double_t a251=-9.64840473508445992784597622371e-06;
                                        
    Double_t a212=47.5868548390417629434523405507;
    Double_t a222=-1.64015079069219593677075863525;
    Double_t a232=0.0218177238068056889019885602465;
    Double_t a242=-0.000138197401300520840731686500469;
    Double_t a252=3.74283331192169170673555381873e-07;
                                                
    Double_t a213=-145.280908187119422336763818748;
    Double_t a223=0.463787914413491986209692186094;
    Double_t a233=0.0321730201461149084574131506997;
    Double_t a243=-0.000305050847329301844448878888727;
    Double_t a253=7.5745582467836168829607287542e-07;
                                            
    Double_t a214=-1655.87004243952355864166747779;
    Double_t a224=19.1507118570349028630062093725;
    Double_t a234=0.0107499137523899643970048956021;
    Double_t a244=-0.00074793642127144051821863168783;
    Double_t a254=2.10579042344223326570836624105e-06;
                                                                               
    Double_t b211=-192.830012519173919827153440565;
    Double_t b221=1.26220344915611137892597071186;
    Double_t b231=0.215013109777751398876688426753;
    Double_t b241=-0.00554737671214569020433637902556;
    Double_t b251=4.25312548961143506920032364427e-05;

    b211=b211*1e-3;
    b221=b221*1e-3;
    b231=b231*1e-3;
    b241=b241*1e-3;
    b251=b251*1e-3;
                                                               
    Double_t b212=-278.541822543976422821287997067;
    Double_t b222=10.3918652240168949418830379727;
    Double_t b232=-0.144304607018130581774784104709;
    Double_t b242=0.000922549365659495459665584427;
    Double_t b252=-2.35736705794803941290782405005e-06;

    b212=b212*1e-3;
    b222=b222*1e-3;
    b232=b232*1e-3;
    b242=b242*1e-3;
    b252=b252*1e-3;
                                                        
    Double_t b213=1543.51696941649015570874325931;
    Double_t b223=-21.7880762675509522807715256931;
    Double_t b233=-0.00194485508538852621893133765241;
    Double_t b243=0.00104669456730295930627083755837;
    Double_t b253=-3.43892469838667967993320676023e-06;

    b213=b213*1e-3;
    b223=b223*1e-3;
    b233=b233*1e-3;
    b243=b243*1e-3;
    b253=b253*1e-3;
                                                             
    Double_t b214=18591.5146084772422909736633301;
    Double_t b224=-222.840246766107014764202176593;
    Double_t b234=0.00109094990789550434773236275987;
    Double_t b244=0.00785613722150584579961840603346;
    Double_t b254=-2.30451046169974113988522523844e-05;

    b214=b214*1e-3;
    b224=b224*1e-3;
    b234=b234*1e-3;
    b244=b244*1e-3;
    b254=b254*1e-3;
                                                                              
    Double_t c211=355.708076574930487367964815348;
    Double_t c221=-3.15825030275451856809354467259;
    Double_t c231=-0.292897132927128545087924749168;
    Double_t c241=0.00765534165046537640880730535287;
    Double_t c251=-5.96120996014632171665532933691e-05;

    c211=c211*1e-6;
    c221=c221*1e-6;
    c231=c231*1e-6;
    c241=c241*1e-6;
    c251=c251*1e-6;
                                             
    Double_t c212=602.170481340616561283241026103;
    Double_t c222=-22.1018450068403460306853958173;
    Double_t c232=0.30624825912073383449296670733;
    Double_t c242=-0.00195285396867941407963997768604;
    Double_t c252=4.87404916324342877924618439023e-06;

    c212=c212*1e-6;
    c222=c222*1e-6;
    c232=c232*1e-6;
    c242=c242*1e-6;
    c252=c252*1e-6;
                                    
    Double_t c213=-2617.98149787897364149102941155;
    Double_t c223=37.6546793744541332671360578388;
    Double_t c233=-0.000779442854891873202968777256672;
    Double_t c243=-0.00183781359192352277374948865685;
    Double_t c253=6.18103944239607378977963483835e-06;

    c213=c213*1e-6;
    c223=c223*1e-6;
    c233=c233*1e-6;
    c243=c243*1e-6;
    c253=c253*1e-6;
                                                 
    Double_t c214=-39514.4542600430868333205580711;
    Double_t c224=476.844180161561212116794195026;
    Double_t c234=-0.0214794822415537711712829604949;
    Double_t c244=-0.0168599370190383179846094208187;
    Double_t c254=4.99471382128903121236720985543e-05;

    c214=c214*1e-6;
    c224=c224*1e-6;
    c234=c234*1e-6;
    c244=c244*1e-6;
    c254=c254*1e-6;
                                                                              
    Double_t d211=-193.935479569752772022184217349;
    Double_t d221=2.14790682860712500712452310836;
    Double_t d231=0.114226168519773144116591367947;
    Double_t d241=-0.00327082553377362359944835468184;
    Double_t d251=2.76875022310005630362707285119e-05;

    d211=d211*1e-9;
    d221=d221*1e-9;
    d231=d231*1e-9;
    d241=d241*1e-9;
    d251=d251*1e-9;
                                                   
    Double_t d212=-366.534391693851318905217340216;
    Double_t d222=13.1306015684250478869898870471;
    Double_t d232=-0.181810619155537173119441263225;
    Double_t d242=0.00117049657021844801668697400032;
    Double_t d252=-2.93313022010264330495911758168e-06;

    d212=d212*1e-9;
    d222=d222*1e-9;
    d232=d232*1e-9;
    d242=d242*1e-9;
    d252=d252*1e-9;
                                                    
    Double_t d213=1349.91019799946843704674392939;
    Double_t d223=-19.6566749325439147355609748047;
    Double_t d233=0.00179585649675323248686265031893;
    Double_t d243=0.000965903890121742533803050889674;
    Double_t d253=-3.28121808321160204246135991268e-06;

    d213=d213*1e-9;
    d223=d223*1e-9;
    d233=d233*1e-9;
    d243=d243*1e-9;
    d253=d253*1e-9;
                                          
    Double_t d214=23834.9249162660635192878544331;
    Double_t d224=-287.952173843357797977660084143;
    Double_t d234=0.00773197553914641618616476748116;
    Double_t d244=0.010275082707815349353230871543;
    Double_t d254=-3.04967335175218731918665021619e-05;

    d214=d214*1e-9;
    d224=d224*1e-9;
    d234=d234*1e-9;
    d244=d244*1e-9;
    d254=d254*1e-9;

    //    700 <= t  <  1340  MeV
                                                                      
    Double_t a311=-16.7339695455916945832086639712;
    Double_t a321=0.410858118520914306071034616252;
    Double_t a331=-0.0291039970348530400989783828436;
    Double_t a341=0.00131336656979566795272473811451;
    Double_t a351=-1.40304452013664640618647444503e-05;
             
    Double_t a312=-97.243735957946256576178711839;
    Double_t a322=4.94550941012511913186244782992;
    Double_t a332=-0.0809429895987969771908865368459;
    Double_t a342=0.000548958152924852683593459623523;
    Double_t a352=-1.34281331734555239156112416837e-06;
                     
    Double_t a313=253.449749073540971266993437894;
    Double_t a323=-5.23614396902913004083757186891;
    Double_t a333=0.0319938469783311169036821297595;
    Double_t a343=-2.6734521353081374734532785209e-05;
    Double_t a353=-1.87085594292834266599761324119e-07;
                     
    Double_t a314=2175.22619228574285443755798042;
    Double_t a324=-26.8974450770923638742715411354;
    Double_t a334=0.0123097935005911374162224092288;
    Double_t a344=0.000874540269287660135613671208432;
    Double_t a354=-2.69577871764866192801622137021e-06;
                      
    Double_t b311=75.5638915386094680570749915205;
    Double_t b321=-2.00629314432976624260618336848;
    Double_t b331=0.117006628757149955255556506017;
    Double_t b341=-0.00427834223263832882228063780872;
    Double_t b351=4.14847938769389570565215841214e-05;

    b311=b311*1e-3;
    b321=b321*1e-3;
    b331=b331*1e-3;
    b341=b341*1e-3;
    b351=b351*1e-3;
                 
    Double_t b312=354.025231102021393780887592584;
    Double_t b322=-16.2257269011451690232661349;
    Double_t b332=0.252563454336966697333366482781;
    Double_t b342=-0.00166129310677967960072076714084;
    Double_t b352=3.99508826717077029477397792645e-06;

    b312=b312*1e-3;
    b322=b322*1e-3;
    b332=b332*1e-3;
    b342=b342*1e-3;
    b352=b352*1e-3;
                                                                              
    Double_t b313=-258.843139531004283071524696425;
    Double_t b323=4.0556987677958513671683249413;
    Double_t b333=-0.00182574325961018545973202353849;
    Double_t b343=-0.000215620484994027874613847783891;
    Double_t b353=8.32636292920065841072197430905e-07;

    b313=b313*1e-3;
    b323=b323*1e-3;
    b333=b333*1e-3;
    b343=b343*1e-3;
    b353=b353*1e-3;
                                                                               
    Double_t b314=-4030.87964950808827779837884009;
    Double_t b324=50.2579233860782892406859900802;
    Double_t b334=-0.0131189571804045824326978575414;
    Double_t b344=-0.00179280965313299411184599918556;
    Double_t b354=5.60765583244705507912292521966e-06;

    b314=b314*1e-3;
    b324=b324*1e-3;
    b334=b334*1e-3;
    b344=b344*1e-3;
    b354=b354*1e-3;
                                                                            
    Double_t c311=-65.5506296675690975916950264946;
    Double_t c321=2.04664273720001688161573838443;
    Double_t c331=-0.120239376925325505696129368971;
    Double_t c341=0.00381717751487100666329954634648;
    Double_t c351=-3.37557337998105043441222916645e-05;

    c311=c311*1e-6;
    c321=c321*1e-6;
    c331=c331*1e-6;
    c341=c341*1e-6;
    c351=c351*1e-6;
                                                                              
    Double_t c312=-322.69010703126673433871474117;
    Double_t c322=14.2113203454018943716619105544;
    Double_t c332=-0.214634219448837648691608137597;
    Double_t c342=0.00137443611676186594819371045162;
    Double_t c352=-3.23225521932178170984081150285e-06;

    c312=c312*1e-6;
    c322=c322*1e-6;
    c332=c332*1e-6;
    c342=c342*1e-6;
    c352=c352*1e-6;
                                                        
    Double_t c313=77.694078567927675749160698615;
    Double_t c323=-1.21371927747354835247506343876;
    Double_t c333=0.000422785591358837290268390951553;
    Double_t c343=6.36538426604389668368375043705e-05;
    Double_t c353=-2.48477943650406968900597745945e-07;

    c313=c313*1e-6;
    c323=c323*1e-6;
    c333=c333*1e-6;
    c343=c343*1e-6;
    c353=c353*1e-6;
                                                                       
    Double_t c314=1796.63173042967559922544751316;
    Double_t c324=-23.1765752135956155655094335089;
    Double_t c334=0.0105074595934139466968382237155;
    Double_t c344=0.000831384373630674258781603214175;
    Double_t c354=-2.70280718020332092306956192629e-06;

    c314=c314*1e-6;
    c324=c324*1e-6;
    c334=c334*1e-6;
    c344=c344*1e-6;
    c354=c354*1e-6;
                                                                              
    Double_t d311=22.2230842525465561720920959488;
    Double_t d321=-0.579628298901678995491693058284;
    Double_t d331=0.0222693439053093661383897483574;
    Double_t d341=-0.000669376958042238270375767772435;
    Double_t d351=5.57826744695680364056035796527e-06;

    d311=d311*1e-9;
    d321=d321*1e-9;
    d331=d331*1e-9;
    d341=d341*1e-9;
    d351=d351*1e-9;
                                                                              
    Double_t d312=87.6065281114019569486117688939;
    Double_t d322=-3.69293224431998279300159992999;
    Double_t d332=0.0530622988574960124941171102364;
    Double_t d342=-0.000320586805899160647709278393336;
    Double_t d352=7.08611834259912403377829146628e-07;

    d312=d312*1e-9;
    d322=d322*1e-9;
    d332=d332*1e-9;
    d342=d342*1e-9;
    d352=d352*1e-9;
                                                                              
    Double_t d313=-3.61188400528913167164546393906;
    Double_t d323=0.0246185836640670854813528478644;
    Double_t d333=0.000218122197264948092850639360663;
    Double_t d343=3.48687468813731748757225089447e-07;
    Double_t d353=-7.51771276949000822424347238726e-09;

    d313=d313*1e-9;
    d323=d323*1e-9;
    d333=d333*1e-9;
    d343=d343*1e-9;
    d353=d353*1e-9;
                                                    
    Double_t d314=-198.497748324768679140106542036;
    Double_t d324=3.46043662596812051646111285663;
    Double_t d334=-0.0133374494190890459377474286384;
    Double_t d344=-4.5201610196021494640465643311e-05;
    Double_t d354=2.65975205805248309254295874943e-07;

    d314=d314*1e-9;
    d324=d324*1e-9;
    d334=d334*1e-9;
    d344=d344*1e-9;
    d354=d354*1e-9;

    //    1340 <= t  <=  2000  MeV
                                                                
    Double_t a411=-12.7584281205485687848977249814;
    Double_t a421=-0.810828830515470055928517467692;
    Double_t a431=0.11727577941561032059958336049;
    Double_t a441=-0.00306471583621413913925413119443;
    Double_t a451=2.33025032084072329771531201237e-05;
                      
    Double_t a412=186.789257366342667410208377987;
    Double_t a422=-9.21831435279970889951073331758;
    Double_t a432=0.166114387907598914928541944391;
    Double_t a442=-0.00128984963387176630386643516601;
    Double_t a452=3.63766099652079555085387556346e-06;
                     
    Double_t a413=166.148351780900185303835314699;
    Double_t a423=-3.62013911872450044882043584948;
    Double_t a433=0.029480687397011533235069435932;
    Double_t a443=-0.000122860581922417641574998836695;
    Double_t a453=2.62166228557376848699720555194e-07;
                   
    Double_t a414=-663.731432312853030452970415354;
    Double_t a424=7.39908390540204052854278415907;
    Double_t a434=0.00845097963381020653161890265892;
    Double_t a444=-0.000327195416702142694888311158508;
    Double_t a454=9.34019306292568798726072554217e-07;
                      
    Double_t b411=36.3514104224731298131700896192;
    Double_t b421=0.992648979911832096689749960206;
    Double_t b431=-0.155508226192793141962056324701;
    Double_t b441=0.00365044881639511268472952920661;
    Double_t b451=-2.46013399286980307854259125699e-05;

    b411=b411*1e-3;
    b421=b421*1e-3;
    b431=b431*1e-3;
    b441=b441*1e-3;
    b451=b451*1e-3;
                     
    Double_t b412=-239.761112400200204319844488055;
    Double_t b422=12.2925220650717026416032240377;
    Double_t b432=-0.226942339023619821247734762437 ;
    Double_t b442=0.00178907310477429727646470070113;
    Double_t b452=-5.09123652905045299716258605516e-06;

    b412=b412*1e-3;
    b422=b422*1e-3;
    b432=b432*1e-3;
    b442=b442*1e-3;
    b452=b452*1e-3;
                                                                              
    Double_t b413=-99.5852780037004521318522165529;
    Double_t b423=1.15049893940818726001396044012;
    Double_t b433=0.00224965626435622619710974490204;
    Double_t b443=-4.52349933879790070279797165043e-05;
    Double_t b453=4.90075033490211781655901228383e-08;

    b413=b413*1e-3;
    b423=b423*1e-3;
    b433=b433*1e-3;
    b443=b443*1e-3;
    b453=b453*1e-3;

    Double_t b414=75.4067144578993548975631711073;
    Double_t b424=-0.217490544894892973148969872454;
    Double_t b434=-0.00260897622163435913278384248315;
    Double_t b444=-9.83624614093839310432348943536e-06;
    Double_t b454=8.7629694551785081163761668456e-08;

    b414=b414*1e-3;
    b424=b424*1e-3;
    b434=b434*1e-3;
    b444=b444*1e-3;
    b454=b454*1e-3;
                                                                              
    Double_t c411=-10.6412055794955957566116921953;
    Double_t c421=-0.330381569766683147459929159595;
    Double_t c431=0.0362084068376701817548735107266;
    Double_t c441=-0.000623612176609370633638407266375;
    Double_t c451=2.26967949415484354847754103202e-06;

    c411=c411*1e-6;
    c421=c421*1e-6;
    c431=c431*1e-6;
    c441=c441*1e-6;
    c451=c451*1e-6;
                                                                              
    Double_t c412= 96.984368712742167417673044838;
    Double_t c422=-5.03771902858119702273143047933;
    Double_t c432=0.0935611355220900969831276938748;
    Double_t c442=-0.000738531655797346935424241287649;
    Double_t c452=2.09926463251303513721105278855e-06;

    c412=c412*1e-6;
    c422=c422*1e-6;
    c432=c432*1e-6;
    c442=c442*1e-6;
    c452=c452*1e-6;
                                                   
    Double_t c413=16.4938353285128656011693237815;
    Double_t c423=-0.0872224255923418623215326306308;
    Double_t c433=-0.00103213661999113862771659810846;
    Double_t c443=-2.76311837271368879165572146617e-06;
    Double_t c453=6.06510519252056225710813784635e-08;

    c413=c413*1e-6;
    c423=c423*1e-6;
    c433=c433*1e-6;
    c443=c443*1e-6;
    c453=c453*1e-6;
                                                                          
    Double_t c414=-13.5246941801859072995739552425;
    Double_t c424=0.0139555380560209656148895618344;
    Double_t c434=0.000342943303929599816511769594385;
    Double_t c444=1.80067948775186561263502230124e-06;
    Double_t c454=-1.37399634317053308094480482734e-09;

    c414=c414*1e-6;
    c424=c424*1e-6;
    c434=c434*1e-6;
    c444=c444*1e-6;
    c454=c454*1e-6;
                                                                              
    Double_t d411=1.37409064370393507736878291325;
    Double_t d421=0.0337998620352999712412866983868;
    Double_t d431=-0.00350402642305315276810562252763;
    Double_t d441=4.50211187966720384500719787102e-05;
    Double_t d451=2.49509890994124017147203983824e-08;

    d411=d411*1e-9;
    d421=d421*1e-9;
    d431=d431*1e-9;
    d441=d441*1e-9;
    d451=d451*1e-9;
                                                                              
    Double_t d412=-12.6140141871848712185055774171;
    Double_t d422=0.655296528252096166511364572216;
    Double_t d432=-0.0121151884191820612829415537703;
    Double_t d442=9.4919155700458497908894583972e-05;
    Double_t d452=-2.67409926416907584979072102366e-07;

    d412=d412*1e-9;
    d422=d422*1e-9;
    d432=d432*1e-9;
    d442=d442*1e-9;
    d452=d452*1e-9;
                                                                              
    Double_t d413=-2.99967585603287245632486701652;
    Double_t d423=0.0196980122736698758101336892423;
    Double_t d433=0.00015637694319464091516867776388;
    Double_t d443=8.79611825939147809168619507325e-09;
    Double_t d453=-7.29544614671841412275198445326e-09;

    d413=d413*1e-9;
    d423=d423*1e-9;
    d433=d433*1e-9;
    d443=d443*1e-9;
    d453=d453*1e-9;
                                                    
    Double_t d414=-75.1430050719748123810859397054;
    Double_t d424=1.47718250176611753943234361941;
    Double_t d434=-0.0102813448497441704138077867015;
    Double_t d444=2.97967323770106104832700033569e-05;
    Double_t d454=-3.14065628401839552416574541382e-08;

    d414=d414*1e-9;
    d424=d424*1e-9;
    d434=d434*1e-9;
    d444=d444*1e-9;
    d454=d454*1e-9;

    //    2000 < t  <=  2500  MeV
                                                                     
    Double_t a511=3.47254972730605349084953559213;
    Double_t a521=-0.472442493833277632475642349164;
    Double_t a531=0.0844983975058501285415601955719;
    Double_t a541=-0.00289197600513564547636269352893;
    Double_t a551=2.79686206727054621887142843439e-05;
                                                                    
    Double_t a512=41.0026020488243716499709989876;
    Double_t a522=-1.68973510327236264849659619358;
    Double_t a532=0.0278155093544221396206772567439;
    Double_t a542=-0.00021377614361777448680028423933;
    Double_t a552=6.28407827389216938936817007794e-07;
                                                              
    Double_t a513=126.145401815058448846684768796;
    Double_t a523=-3.30663136057926276833995871129;
    Double_t a533=0.030621248060286872932911350631;
    Double_t a543=-0.000117386783252675192478452215195;
    Double_t a553=1.56039022867282605495518801181e-07;
                                                         
    Double_t a514=106.035560296066151408922451083;
    Double_t a524=-1.29832575078676204505256919219;
    Double_t a534=0.00691378047701294087823420397854;
    Double_t a544=-2.26807633859038199649997558094e-05;
    Double_t a554=3.00202057378542013940005551802e-08;
                                                                     
    Double_t b511=14.892382942754631258708286623;
    Double_t b521=0.490092437647822287694054921303;
    Double_t b531=-0.10546489508652936994970161777;
    Double_t b541=0.00316406831751831971177857383282;
    Double_t b551=-2.77412687603658411703705377604e-05;

    b511=b511*1e-3;
    b521=b521*1e-3;
    b531=b531*1e-3;
    b541=b541*1e-3;
    b551=b551*1e-3;
                                                             
    Double_t b512=-42.9571753416644810386060271412;
    Double_t b522=2.12817208154404724496089329477;
    Double_t b532=-0.0400784399115883746556043831788;
    Double_t b542=0.000333216623668915559210168542137;
    Double_t b552=-1.01268129473815318322249112021e-06;

    b512=b512*1e-3;
    b522=b522*1e-3;
    b532=b532*1e-3;
    b542=b542*1e-3;
    b552=b552*1e-3;
                                                                      
    Double_t b513=-75.7623276044806175377743784338;
    Double_t b523=1.21688087513552511964576297032;
    Double_t b533=-0.000571654488810795116497665002697;
    Double_t b543=-6.43400797409955692643390712249e-05;
    Double_t b553=2.41453969535879873514912490745e-07;

    b513=b513*1e-3;
    b523=b523*1e-3;
    b533=b533*1e-3;
    b543=b543*1e-3;
    b553=b553*1e-3;
                                   
    Double_t b514=50.1659294334849619190208613873;
    Double_t b524=-0.244392960152603477830268730031;
    Double_t b534=-0.00222104303245211761805300021422;
    Double_t b544=-6.05102103083740854879259488119e-06;
    Double_t b554=1.06693943121853981838787416795e-07;

    b514=b514*1e-3;
    b524=b524*1e-3;
    b534=b534*1e-3;
    b544=b544*1e-3;
    b554=b554*1e-3;
                                                                       
    Double_t c511=-1.2281240374562036876682213915;
    Double_t c521=-0.0935125321937136100292065066242;
    Double_t c531=0.0120451574968636777179797903159;
    Double_t c541=-0.000320836910158153396088742681513;
    Double_t c551=2.57420317088220611620062380775e-06;

    c511=c511*1e-6;
    c521=c521*1e-6;
    c531=c531*1e-6;
    c541=c541*1e-6;
    c551=c551*1e-6;
                                                                     
    Double_t c512=10.5342635624410512207305146148;
    Double_t c522=-0.561406402681982275026939532836;
    Double_t c532=0.0110607484615416820639133277382;
    Double_t c542=-9.41453116249860974583743566946e-05;
    Double_t c552=2.89378550361483640720929727541e-07;

    c512=c512*1e-6;
    c522=c522*1e-6;
    c532=c532*1e-6;
    c542=c542*1e-6;
    c552=c552*1e-6;
                                                                
    Double_t c513=-1.33646152633203207926726463484;
    Double_t c523=0.00278316057281262699274471117405;
    Double_t c533=4.79388293232475273461523634921e-05;
    Double_t c543=2.38916568395885109922700297036e-07;
    Double_t c553=-1.50487147925811429349969318279e-09;

    c513=c513*1e-6;
    c523=c523*1e-6;
    c533=c533*1e-6;
    c543=c543*1e-6;
    c553=c553*1e-6;
                                                                     
    Double_t c514=-12.1640170879757292254907952156;
    Double_t c524=0.0536441980651616856512475806085;
    Double_t c534=0.000515937344651880226871487611362;
    Double_t c544=1.1629171556611996259832575093e-06;
    Double_t c554=-2.15528719727046081781703557208e-08;

    c514=c514*1e-6;
    c524=c524*1e-6;
    c534=c534*1e-6;
    c544=c544*1e-6;
    c554=c554*1e-6;

    //    2500 < t  <=  3000  MeV
                                                                     
    Double_t a611=7.76189989283533332553588479641;
    Double_t a621=-0.601143002261986358902845495322;
    Double_t a631=0.0936460242763701433688083852758;
    Double_t a641=-0.0032888371410665188931954361351;
    Double_t a651=3.29364032522508028751756503638e-05;
                                                                      
    Double_t a612=-58.4487101376154143395069695543;
    Double_t a622=3.71211975107332792234160478984;
    Double_t a632=-0.0751862587212258765001493543423;
    Double_t a642=0.000620298842829583065017207132996;
    Double_t a652=-1.81605524824121946356799556233e-06;
                                                              
    Double_t a613=431.45095193914301034965319559;
    Double_t a623=-7.96518268410425189784973554197;
    Double_t a633=0.0331194660629376760874187368699;
    Double_t a643=0.000111786130084919578466136347306;
    Double_t a653=-7.05560663993457093486527578058e-07;
                                                                      
    Double_t a614=-224.96614331268523301332606934;
    Double_t a624=1.85520376158219457707332367136;
    Double_t a634=0.0104944722178547406726822899259;
    Double_t a644=-0.000113378393613579255168322124092;
    Double_t a654=1.89335051033456154384899548966e-07;
                                                                     
    Double_t b611=11.0746037373865551245444294182;
    Double_t b621=0.583715251026991621685624522797;
    Double_t b631=-0.111341554452420499199405412583;
    Double_t b641=0.00344661054647033091719032782407;
    Double_t b651=-3.14497813364071510003165677016e-05;

    b611=b611*1e-3;
    b621=b621*1e-3;
    b631=b631*1e-3;
    b641=b641*1e-3;
    b651=b651*1e-3;
                                                                 
    Double_t b612=36.3398674187633119458951114211;
    Double_t b622=-2.18632192076425857507615546638;
    Double_t b632=0.0423582724740546937014507022923;
    Double_t b642=-0.000335326314791576317840549048555;
    Double_t b652=9.47820711779222465385790711428e-07;

    b612=b612*1e-3;
    b622=b622*1e-3;
    b632=b632*1e-3;
    b642=b642*1e-3;
    b652=b652*1e-3;
                                                                        
    Double_t b613=-314.434305516411654934927355498;
    Double_t b623=4.85782013260413059185793827055;
    Double_t b633=-0.00254127727057998180348885597368;
    Double_t b643=-0.000243568363681340681325959707237;
    Double_t b653=9.16602316359141307050215075058e-07 ;

    b613=b613*1e-3;
    b623=b623*1e-3;
    b633=b633*1e-3;
    b643=b643*1e-3;
    b653=b653*1e-3;
                                                    
    Double_t b614=122.255212405983868961811822373;
    Double_t b624=-0.501935381644469824635734767071;
    Double_t b634=-0.00494559003534167113819153271947;
    Double_t b644=-1.29234427670443976891596210566e-05;
    Double_t b654=2.11404279646859644141074479479e-07;

    b614=b614*1e-3;
    b624=b624*1e-3;
    b634=b634*1e-3;
    b644=b644*1e-3;
    b654=b654*1e-3;
                                                                  
    Double_t c611=-0.387983460867299512209172007715;
    Double_t c621=-0.110273414905126709850691213433;
    Double_t c631=0.0129259982507889288616542700083;
    Double_t c641=-0.000370164157147797462377170063519;
    Double_t c651=3.2607877922726573137598635177e-06;

    c611=c611*1e-6;
    c621=c621*1e-6;
    c631=c631*1e-6;
    c641=c641*1e-6;
    c651=c651*1e-6;
                                                                       
    Double_t c612=-5.28836907884832818638187745819;
    Double_t c622=0.301034869790244963283498691453;
    Double_t c632=-0.00545235730130092660639107293719;
    Double_t c642=3.99746399486888086250400975441e-05;
    Double_t c652=-1.04164737711753453109714490435e-07;

    c612=c612*1e-6;
    c622=c622*1e-6;
    c632=c632*1e-6;
    c642=c642*1e-6;
    c652=c652*1e-6;
                                                                        
    Double_t c613=46.0984068296820339583064196631;
    Double_t c623=-0.719017618428171689792804954777;
    Double_t c633=0.000416809160160313478364624284467;
    Double_t c643=3.59947102951256895850273842541e-05;
    Double_t c653=-1.36143522112717418406189627718e-07;

    c613=c613*1e-6;
    c623=c623*1e-6;
    c633=c633*1e-6;
    c643=c643*1e-6;
    c653=c653*1e-6;
                                                                              
    Double_t c614=-26.4277070391693342799044330604;
    Double_t c624=0.104450195975400034198443677269;
    Double_t c634=0.001053876893611264660768900292;
    Double_t c644=2.52018030772574403041330799724e-06;
    Double_t c654=-4.22182636597867544172762229327e-08;

    c614=c614*1e-6;
    c624=c624*1e-6;
    c634=c634*1e-6;
    c644=c644*1e-6;
    c654=c654*1e-6;
    
    Double_t A0=0,A1=0,A2=0,A3=0,A4=0;
    //Double_t avper;
    //Int_t i;
  
    Double_t dsg_calc=0;
  
    if( Tlab >= 1 && Tlab <= 10) {    
	if(th <= 48) {	
	    A0=a711+a721*th+a731*pow(th,2);
	    A1=b711+b721*th+b731*pow(th,2);
	    A2=c711+c721*th+c731*pow(th,2);
	    A3=d711+d721*th+d731*pow(th,2);
	    A4=e711+e721*th+e731*pow(th,2);
	}      
	if(th > 48 && th <= 123) {	
	    A0=a712+a722*th+a732*pow(th,2);
	    A1=b712+b722*th+b732*pow(th,2);
	    A2=c712+c722*th+c732*pow(th,2);
	    A3=d712+d722*th+d732*pow(th,2);
	    A4=e712+e722*th+e732*pow(th,2);
	}      
	if(th > 123 && th <= 159) {	
	    A0=a713+a723*th+a733*pow(th,2);
	    A1=b713+b723*th+b733*pow(th,2);
	    A2=c713+c723*th+c733*pow(th,2);
	    A3=d713+d723*th+d733*pow(th,2);
	    A4=e713+e723*th+e733*pow(th,2);
	}      
	if(th > 159 && th <= 180) {	
	    A0=a714+a724*th+a734*pow(th,2);
	    A1=b714+b724*th+b734*pow(th,2);
	    A2=c714+c724*th+c734*pow(th,2);
	    A3=d714+d724*th+d734*pow(th,2);
	    A4=e714+e724*th+e734*pow(th,2);
	}      
	dsg_calc=A0*pow(Tlab,A1*pow(Tlab,A2))+A3+A4*Tlab;
	if( Tlab >=1 && Tlab < 2) dsg_calc=1.077*dsg_calc;   
    }
     
    if( Tlab >10  && Tlab <= 150) {      
	if(th <= 51) {	
	    A0=a011+a021*th+a031*pow(th,2)+a041*pow(th,3)+a051*pow(th,4);
	}
	if(th <= 39) {
	    A1=b011+b021*th+b031*pow(th,2)+b041*pow(th,3)+b051*pow(th,4);	
	}
	if(th <= 60) {
	    A2=c011+c021*th+c031*pow(th,2)+c041*pow(th,3)+c051*pow(th,4);
	}
	if(th <= 57) {
	    A3=d011+d021*th+d031*pow(th,2)+d041*pow(th,3)+d051*pow(th,4);
	    A4=e011+e021*th+e031*pow(th,2)+e041*pow(th,3)+e051*pow(th,4);
	}
	if(th > 51 && th <= 123) {
	    A0=a012+a022*th+a032*pow(th,2)+a042*pow(th,3)+a052*pow(th,4);	
	}
	if(th > 39 && th <= 123) {
	    A1=b012+b022*th+b032*pow(th,2)+b042*pow(th,3)+b052*pow(th,4);	
	}
	if(th > 60 && th <= 126) {
	    A2=c012+c022*th+c032*pow(th,2)+c042*pow(th,3)+c052*pow(th,4);
	}
	if(th > 57 && th <= 123) {
	    A3=d012+d022*th+d032*pow(th,2)+d042*pow(th,3)+d052*pow(th,4);
	    A4=e012+e022*th+e032*pow(th,2)+e042*pow(th,3)+e052*pow(th,4);
	}
	if(th > 123 && th <= 153) {
	    A0=a013+a023*th+a033*pow(th,2)+a043*pow(th,3)+a053*pow(th,4);
	    A1=b013+b023*th+b033*pow(th,2)+b043*pow(th,3)+b053*pow(th,4);
	    A3=d013+d023*th+d033*pow(th,2)+d043*pow(th,3)+d053*pow(th,4);
	    A4=e013+e023*th+e033*pow(th,2)+e043*pow(th,3)+e053*pow(th,4);
	}
	if(th > 126 && th <= 153) {
	    A2=c013+c023*th+c033*pow(th,2)+c043*pow(th,3)+c053*pow(th,4);	
	}
	if(th > 153 && th <= 180) {
	    A0=a014+a024*th+a034*pow(th,2)+a044*pow(th,3)+a054*pow(th,4);
	    A1=b014+b024*th+b034*pow(th,2)+b044*pow(th,3)+b054*pow(th,4);
	    A2=c014+c024*th+c034*pow(th,2)+c044*pow(th,3)+c054*pow(th,4);
	    A3=d014+d024*th+d034*pow(th,2)+d044*pow(th,3)+d054*pow(th,4);
	    A4=e014+e024*th+e034*pow(th,2)+e044*pow(th,3)+e054*pow(th,4);
	}      
	dsg_calc=A0*pow(Tlab,A1*pow(Tlab,A2))+A3+A4*Tlab;
    }

    if( Tlab > 150 && Tlab <= 370) {
	if(th <= 51) {
	    A0=a111+a121*th+a131*pow(th,2)+a141*pow(th,3)+a151*pow(th,4);		
	}
	if(th <= 39) {
	    A1=b111+b121*th+b131*pow(th,2)+b141*pow(th,3)+b151*pow(th,4);		
	}
	if(th <= 60) {
	    A2=c111+c121*th+c131*pow(th,2)+c141*pow(th,3)+c151*pow(th,4);	
	}
	if(th <= 57) {
	    A3=d111+d121*th+d131*pow(th,2)+d141*pow(th,3)+d151*pow(th,4);	
	}
	if(th > 51 && th <= 123) {
	    A0=a112+a122*th+a132*pow(th,2)+a142*pow(th,3)+a152*pow(th,4);	
	}
	if(th > 39 && th <= 123) {
	    A1=b112+b122*th+b132*pow(th,2)+b142*pow(th,3)+b152*pow(th,4);	
	}
	if(th > 60 && th <= 126) {
	    A2=c112+c122*th+c132*pow(th,2)+c142*pow(th,3)+c152*pow(th,4);	
	}
	if(th > 57 && th <= 123) {
	    A3=d112+d122*th+d132*pow(th,2)+d142*pow(th,3)+d152*pow(th,4);
	}
	if(th > 123 && th <= 153) {
	    A0=a113+a123*th+a133*pow(th,2)+a143*pow(th,3)+a153*pow(th,4);
	    A1=b113+b123*th+b133*pow(th,2)+b143*pow(th,3)+b153*pow(th,4);
	    A3=d113+d123*th+d133*pow(th,2)+d143*pow(th,3)+d153*pow(th,4);
	}
	if(th > 126 && th <= 153) {
	    A2=c113+c123*th+c133*pow(th,2)+c143*pow(th,3)+c153*pow(th,4);	
	}
	if(th > 153 && th <= 180) {
	    A0=a114+a124*th+a134*pow(th,2)+a144*pow(th,3)+a154*pow(th,4);
	    A1=b114+b124*th+b134*pow(th,2)+b144*pow(th,3)+b154*pow(th,4);
	    A2=c114+c124*th+c134*pow(th,2)+c144*pow(th,3)+c154*pow(th,4);
	    A3=d114+d124*th+d134*pow(th,2)+d144*pow(th,3)+d154*pow(th,4);	
	}
	dsg_calc=A0+A1*Tlab+A2*pow(Tlab,2)+A3*pow(Tlab,3);    
    } 

    if( Tlab >= 370 && Tlab < 700) {
	if(th <= 51) {
	    A0=a211+a221*th+a231*pow(th,2)+a241*pow(th,3)+a251*pow(th,4);
	    A1=b211+b221*th+b231*pow(th,2)+b241*pow(th,3)+b251*pow(th,4);
	    A2=c211+c221*th+c231*pow(th,2)+c241*pow(th,3)+c251*pow(th,4);
	    A3=d211+d221*th+d231*pow(th,2)+d241*pow(th,3)+d251*pow(th,4);
	}
	if(th > 51 && th <= 123) {
	    A0=a212+a222*th+a232*pow(th,2)+a242*pow(th,3)+a252*pow(th,4);
	    A1=b212+b222*th+b232*pow(th,2)+b242*pow(th,3)+b252*pow(th,4);
	    A2=c212+c222*th+c232*pow(th,2)+c242*pow(th,3)+c252*pow(th,4);
	    A3=d212+d222*th+d232*pow(th,2)+d242*pow(th,3)+d252*pow(th,4);
	}
	if(th > 123 && th <= 153) {
	    A0=a213+a223*th+a233*pow(th,2)+a243*pow(th,3)+a253*pow(th,4);
	    A1=b213+b223*th+b233*pow(th,2)+b243*pow(th,3)+b253*pow(th,4);
	    A2=c213+c223*th+c233*pow(th,2)+c243*pow(th,3)+c253*pow(th,4);
	    A3=d213+d223*th+d233*pow(th,2)+d243*pow(th,3)+d253*pow(th,4);
	}
	if(th > 153 && th <= 180) {
	    A0=a214+a224*th+a234*pow(th,2)+a244*pow(th,3)+a254*pow(th,4);
	    A1=b214+b224*th+b234*pow(th,2)+b244*pow(th,3)+b254*pow(th,4);
	    A2=c214+c224*th+c234*pow(th,2)+c244*pow(th,3)+c254*pow(th,4);
	    A3=d214+d224*th+d234*pow(th,2)+d244*pow(th,3)+d254*pow(th,4);
	}
	dsg_calc=A0+A1*Tlab+A2*pow(Tlab,2)+A3*pow(Tlab,3);
    }

    if( Tlab >= 700 && Tlab < 1340) {
	if(th <= 51) {
	    A0=a311+a321*th+a331*pow(th,2)+a341*pow(th,3)+a351*pow(th,4);
	    A1=b311+b321*th+b331*pow(th,2)+b341*pow(th,3)+b351*pow(th,4);
	    A2=c311+c321*th+c331*pow(th,2)+c341*pow(th,3)+c351*pow(th,4);
	    A3=d311+d321*th+d331*pow(th,2)+d341*pow(th,3)+d351*pow(th,4);
	}
	if(th > 51 && th <= 123) {
	    A0=a312+a322*th+a332*pow(th,2)+a342*pow(th,3)+a352*pow(th,4);
	    A1=b312+b322*th+b332*pow(th,2)+b342*pow(th,3)+b352*pow(th,4);
	    A2=c312+c322*th+c332*pow(th,2)+c342*pow(th,3)+c352*pow(th,4);
	    A3=d312+d322*th+d332*pow(th,2)+d342*pow(th,3)+d352*pow(th,4);
	}
	if(th > 123 && th <= 153) {
	    A0=a313+a323*th+a333*pow(th,2)+a343*pow(th,3)+a353*pow(th,4);
	    A1=b313+b323*th+b333*pow(th,2)+b343*pow(th,3)+b353*pow(th,4);
	    A2=c313+c323*th+c333*pow(th,2)+c343*pow(th,3)+c353*pow(th,4);
	    A3=d313+d323*th+d333*pow(th,2)+d343*pow(th,3)+d353*pow(th,4);
	}
	if(th > 153 && th <= 180) {
	    A0=a314+a324*th+a334*pow(th,2)+a344*pow(th,3)+a354*pow(th,4);
	    A1=b314+b324*th+b334*pow(th,2)+b344*pow(th,3)+b354*pow(th,4);
	    A2=c314+c324*th+c334*pow(th,2)+c344*pow(th,3)+c354*pow(th,4);
	    A3=d314+d324*th+d334*pow(th,2)+d344*pow(th,3)+d354*pow(th,4);
	}
	dsg_calc=A0+A1*Tlab+A2*pow(Tlab,2)+A3*pow(Tlab,3); 
    }

    if( Tlab >= 1340 && Tlab <= 2000) {
	if(th <= 51) {
	    A0=a411+a421*th+a431*pow(th,2)+a441*pow(th,3)+a451*pow(th,4);
	    A1=b411+b421*th+b431*pow(th,2)+b441*pow(th,3)+b451*pow(th,4);
	    A2=c411+c421*th+c431*pow(th,2)+c441*pow(th,3)+c451*pow(th,4);
	    A3=d411+d421*th+d431*pow(th,2)+d441*pow(th,3)+d451*pow(th,4);
	}
	//    if(th > 51 && th[i] <= 123) {
	if(th > 51 && th <= 123) {
	    A0=a412+a422*th+a432*pow(th,2)+a442*pow(th,3)+a452*pow(th,4);
	    A1=b412+b422*th+b432*pow(th,2)+b442*pow(th,3)+b452*pow(th,4);
	    A2=c412+c422*th+c432*pow(th,2)+c442*pow(th,3)+c452*pow(th,4);
	    A3=d412+d422*th+d432*pow(th,2)+d442*pow(th,3)+d452*pow(th,4);
	}
	if(th > 123 && th <= 153) {
	    A0=a413+a423*th+a433*pow(th,2)+a443*pow(th,3)+a453*pow(th,4);
	    A1=b413+b423*th+b433*pow(th,2)+b443*pow(th,3)+b453*pow(th,4);
	    A2=c413+c423*th+c433*pow(th,2)+c443*pow(th,3)+c453*pow(th,4);
	    A3=d413+d423*th+d433*pow(th,2)+d443*pow(th,3)+d453*pow(th,4);
	}
	if(th > 153 && th <= 180) {
	    A0=a414+a424*th+a434*pow(th,2)+a444*pow(th,3)+a454*pow(th,4);
	    A1=b414+b424*th+b434*pow(th,2)+b444*pow(th,3)+b454*pow(th,4);
	    A2=c414+c424*th+c434*pow(th,2)+c444*pow(th,3)+c454*pow(th,4);
	    A3=d414+d424*th+d434*pow(th,2)+d444*pow(th,3)+d454*pow(th,4);
	}
	dsg_calc=A0+A1*Tlab+A2*pow(Tlab,2)+A3*pow(Tlab,3);
    }

    if( Tlab > 2000 && Tlab <= 2500) {
	if(th <= 48) {
	    A0=a511+a521*th+a531*pow(th,2)+a541*pow(th,3)+a551*pow(th,4);
	    A1=b511+b521*th+b531*pow(th,2)+b541*pow(th,3)+b551*pow(th,4);
	    A2=c511+c521*th+c531*pow(th,2)+c541*pow(th,3)+c551*pow(th,4);
	}
	if(th > 48 && th <= 123) {
	    A0=a512+a522*th+a532*pow(th,2)+a542*pow(th,3)+a552*pow(th,4);
	    A1=b512+b522*th+b532*pow(th,2)+b542*pow(th,3)+b552*pow(th,4);
	    A2=c512+c522*th+c532*pow(th,2)+c542*pow(th,3)+c552*pow(th,4);
	}
	if(th > 123 && th <= 159) {
	    A0=a513+a523*th+a533*pow(th,2)+a543*pow(th,3)+a553*pow(th,4);
	    A1=b513+b523*th+b533*pow(th,2)+b543*pow(th,3)+b553*pow(th,4);
	    A2=c513+c523*th+c533*pow(th,2)+c543*pow(th,3)+c553*pow(th,4);
	}
	if(th > 159 && th <= 180) {
	    A0=a514+a524*th+a534*pow(th,2)+a544*pow(th,3)+a554*pow(th,4);
	    A1=b514+b524*th+b534*pow(th,2)+b544*pow(th,3)+b554*pow(th,4);
	    A2=c514+c524*th+c534*pow(th,2)+c544*pow(th,3)+c554*pow(th,4);
	}
	dsg_calc=A0+A1*Tlab+A2*pow(Tlab,2);
    }

    if( Tlab > 2500 && Tlab <= 3000) {
	if(th <= 48) {
	    A0=a611+a621*th+a631*pow(th,2)+a641*pow(th,3)+a651*pow(th,4);
	    A1=b611+b621*th+b631*pow(th,2)+b641*pow(th,3)+b651*pow(th,4);
	    A2=c611+c621*th+c631*pow(th,2)+c641*pow(th,3)+c651*pow(th,4);
	}
	if(th > 48 && th <= 123) {
	    A0=a612+a622*th+a632*pow(th,2)+a642*pow(th,3)+a652*pow(th,4);
	    A1=b612+b622*th+b632*pow(th,2)+b642*pow(th,3)+b652*pow(th,4);
	    A2=c612+c622*th+c632*pow(th,2)+c642*pow(th,3)+c652*pow(th,4);
	}
	if(th > 123 && th <= 159) {
	    A0=a613+a623*th+a633*pow(th,2)+a643*pow(th,3)+a653*pow(th,4);
	    A1=b613+b623*th+b633*pow(th,2)+b643*pow(th,3)+b653*pow(th,4);
	    A2=c613+c623*th+c633*pow(th,2)+c643*pow(th,3)+c653*pow(th,4);
	}
	if(th > 159 && th <= 180) {
	    A0=a614+a624*th+a634*pow(th,2)+a644*pow(th,3)+a654*pow(th,4);
	    A1=b614+b624*th+b634*pow(th,2)+b644*pow(th,3)+b654*pow(th,4);
	    A2=c614+c624*th+c634*pow(th,2)+c644*pow(th,3)+c654*pow(th,4);
	}
	dsg_calc = A0+A1*Tlab+A2*pow(Tlab,2);
    }
	
    return dsg_calc;
}

double PSaidPN::sample(double r, double tlab) {
    const double fac = 1.3;
    int i, j;
    // _____________________________________________________________________
    // enter whenever beam energy changes, to calculate integrals and slopes
    if (told != tlab) {
	told = tlab;
	double sum = 0.;
	for (i=0; i<=dim; ++i) {
	    y[i] = fac * dsdw((double)(i+1), tlab);
	}
	for (i=0; i<dim; ++i) {
	    sum += (y[i+1]>y[i]) ? y[i+1] : y[i] ;
	    aa[i] = sum;
	}
    }
  
    // _____________________________________________________________________
    // sample cm scattering angle with the rejection method
    double rr, f, tf, r2, c0, r1 = r;

 repeat:
    //    i=(r1>.5);
    // rr=(2.*r1-i)*aa[dim-1];
    rr = r1*aa[dim-1];
    for (j=0; j<dim; ++j) {
	if (rr < aa[j]) break;
    }
    if (j) rr -= aa[j-1];
    tf = (y[j+1]>y[j]) ? y[j+1]: y[j];
    c0 = rr/tf+1.+j;
    f = dsdw(c0,tlab);
    //r2=REngine->Rndm();
    r2 = PUtils::sampleFlat();
    if (r2 > f/tf) goto fail;
    //if (f<=tf) return (1-2*i)*cos(c0*d2r);
    if (f <= tf) return cos(c0*d2r);

    Warning("sample", "sampling failed f=%lf, tf=%lf", f, tf);
    exit(1);

 fail:
    //r1=REngine->Rndm();
    r1 = PUtils::sampleFlat();
    goto repeat;
}


ClassImp(PSaidPN)
